/**
 * New node file
 */


function run(strInputPath, strOutputPath){
	strPackagingCli = '/usr/local/bin/MP4Box  -inter 500 ' + strInputPath
			+ ' -out ' + strOutputPath;
	Common.log('Packaging processing ' + strPackagingCli);

	strOutput = Common.execCli(strPackagingCli, true);
	checkError(strOutput);

	Common.log('Delete temporary file');
	var fs = require('fs');
	fs.unlinkSync(strInputPath);
}

function checkError(strPackOutput) {
	reg = new RegExp(/Error.*/gm);
	objError = strPackOutput.match(reg);
	if (objError != null) {
		throw new Error(objError[0]);
	}
}

module.exports = {
	run : run
};